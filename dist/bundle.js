!function(t){var e={};function s(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)s.d(i,r,function(e){return t[e]}.bind(null,r));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=0)}([function(t,e,s){"use strict";s.r(e);class i{constructor(t,e,s){this.context=t,this.camera=e,this.canvas=s}draw(t){this.context.beginPath(),t.draw(this),this.context.stroke()}arc(t,e,s,i,r){return this.context.arc(this.camera.X(t),this.camera.Y(e),this.camera.zTransform(s),i,r),this}write(t,e){const s=t.getFontSize(),i=t.getFontFamily(),r=t.getCoordinates();this.context.beginPath(),this.context.font=`${fontSize}px ${i}`,e.map((t,e)=>{this.context.fillText(t,r.x,r.y+s*e)})}fill(t){return this.context.fillStyle=t,this.context.fill(),this}}class r{constructor(t,e,s){this.canvas=document.createElement("canvas"),this.canvas.width=t,this.canvas.height=e,this.context=new i(this.canvas.getContext("2d"),s,this),this.entities=[]}appendTo(t){t.appendChild(this.canvas)}update(t){this.entities.forEach(e=>{e.update(t),e.draw(t,this.context)})}}class o{constructor(t,e,s){this.coords=t,this.radius=e,this.color=s}draw(t){t.arc(this.coords.x,this.coords.y,this.radius,0,2*Math.PI),t.fill(this.color)}getCoordinates(){return this.coords}setCoordinates(t){this.coords=t}}const a=6.674*Math.pow(10,-11);var n;!function(t){t[t.PLAY=0]="PLAY",t[t.PAUSE=1]="PAUSE"}(n||(n={}));n.PLAY;var c=7884e3,h=18e7,d=a,l=1,u=2.5,y=.1,m=25,x=1e4,f=1e4,p=.1,v=29780;const b=(t,e)=>{const s=((t,e)=>(Math.abs(e.x-t.x)+Math.abs(e.y-t.y))*h)(t.coords,e.coords);if(0==s||Number.isNaN(s))return;return d*(t.mass*e.mass/(s*s))*l},w=(t,e,s,i)=>-(t-e)/(Math.abs(s.x-i.x)+Math.abs(s.y-i.y));var g=(t,e,s,i)=>{const r=b(e,s)/e.mass/h;t.accelerate(r*w(e.coords.x,s.coords.x,e.coords,s.coords),r*w(e.coords.y,s.coords.y,e.coords,s.coords),i)};class z{constructor(t,e,s,i,r,a,n){this.id=t,this.coords=e,this.radius=s,this.mass=i,this.color=r,this.velocity=a,this.planets=n,this.entities=[],this.model=new o(this.coords,this.radius,this.color)}getEntities(){return this.entities}update(t){for(let e in this.planets){const s=this.planets[e];s.id!=this.id&&g(this.velocity,this,s,t)}this.velocity.apply(this.coords,t),this.entities.forEach(e=>e.update(t))}draw(t,e){e.draw(this.model)}getCoordinates(){return this.coords}setCoordinates(t){this.coords=t}}class P{constructor(){this.entities=[]}update(t){this.entities.forEach(e=>e.update(t))}draw(t,e){e.context.clearRect(0,0,e.canvas.canvas.width,e.canvas.canvas.height),e.canvas.canvas.style.backgroundColor="#000000",this.entities.forEach(s=>s.draw(t,e)),e.context.stroke()}getEntities(){return this.entities}}class S{constructor(t,e,s){this.x=0,this.y=0,this.z=1,this.x=t,this.y=e,this.z=s}X(t){return this.zTransform(t-this.x)}Y(t){return this.zTransform(t-this.y)}zTransform(t){return t*(1/this.z)}relativeX(t){return this.x+t}relativeY(t){return this.y+t}}class C{constructor(t,e){this.camera=t,this.canvas=e,this.actionByKeycode={82:()=>{this.camera.x=0,this.camera.y=0,this.camera.z=1},90:()=>{this.camera.z<=p||(this.camera.z-=y)},88:()=>{this.camera.z+=y},37:()=>{this.camera.x-m<=0||(this.camera.x-=m)},38:()=>{this.camera.y-m<=0||(this.camera.y-=m)},39:()=>{this.camera.x>=x||(this.camera.x+=m)},40:()=>{this.camera.y>=f||(this.camera.y+=m)}}}handleKeyboard(t){null!=this.actionByKeycode&&this.actionByKeycode[t.keyCode]&&this.actionByKeycode[t.keyCode]()}}class E{constructor(t,e){this.x=t,this.y=e}accelerate(t,e,s){this.x+=t*s,this.y+=e*s}apply(t,e){t.x+=this.x*e,t.y+=this.y*e}}class M{constructor(t,e){this.x=t,this.y=e}setCoordinates(t,e){this.x=t,this.y=e}}const T=(t,e,s)=>{s.update(e/1e3*c),window.requestAnimationFrame(e=>T(e,e-t,s))};document.onreadystatechange=function(){if("complete"!=document.readyState)return;const t=new S(x/2,f/2,u),e=new r(document.body.clientWidth,document.body.clientHeight,t);e.appendTo(document.body);const s=new P,i=new C(t,e),o=((t,e)=>{const s={x:e.relativeX(e.z*(t.canvas.width/2)),y:e.relativeY(e.z*(t.canvas.height/2)),radius:120,mass:1.9891e30,color:"orange",velocity:[0,0]};return{sun41:s,"earth alors":{x:s.x-14996e7/h,y:s.y,radius:30,mass:5972e21,color:"skyblue",velocity:[v/h*1/3,v/h*2/3]},interloper:{x:s.x+10096e7/h,y:s.y+20,radius:24,mass:3972e21,color:"red",velocity:[v/h*1/3,v/h*2/3]}}})(e,t);let a=[];document.querySelector("body").addEventListener("keydown",i.handleKeyboard.bind(i));for(let t in o){const e=o[t];a.push(new z(t,new M(e.x,e.y),e.radius,e.mass,e.color,new E(e.velocity[0],e.velocity[1]),a))}s.entities=a,e.entities.push(s),T(0,0,e)}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL0NhbnZhcy9Db250ZXh0LnRzIiwid2VicGFjazovLy8uL3NyYy9DYW52YXMvQ2FudmFzLnRzIiwid2VicGFjazovLy8uL3NyYy9Nb2RlbC9EaXNjLnRzIiwid2VicGFjazovLy8uL3NyYy9Db25maWcudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL1BoeXNpYy9HZW9tZXRyeS50cyIsIndlYnBhY2s6Ly8vLi9zcmMvUGh5c2ljL0dyYXZpdHkudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL1BsYW5ldC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvU2NlbmUvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL0NhbWVyYS9DYW1lcmEudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL0NvbnRyb2xzL0tleWJvYXJkLnRzIiwid2VicGFjazovLy8uL3NyYy9QaHlzaWMvVmVsb2NpdHkudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL1BoeXNpYy9Db29yZGluYXRlcy50cyIsIndlYnBhY2s6Ly8vLi9pbmRleC50cyIsIndlYnBhY2s6Ly8vLi9wbGFuZXRzLnRzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiQ29udGV4dCIsImNvbnRleHQiLCJjYW1lcmEiLCJjYW52YXMiLCJtb2RlbCIsInRoaXMiLCJiZWdpblBhdGgiLCJkcmF3Iiwic3Ryb2tlIiwieCIsInkiLCJhcyIsImFlIiwiYXJjIiwiWCIsIlkiLCJ6VHJhbnNmb3JtIiwidGV4dCIsImxpbmVzIiwiZnMiLCJnZXRGb250U2l6ZSIsImZmIiwiZ2V0Rm9udEZhbWlseSIsImdldENvb3JkaW5hdGVzIiwiZm9udCIsImZvbnRTaXplIiwibWFwIiwibGluZSIsImZpbGxUZXh0IiwiY29sb3IiLCJmaWxsU3R5bGUiLCJmaWxsIiwid2lkdGgiLCJoZWlnaHQiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJnZXRDb250ZXh0IiwiZW50aXRpZXMiLCJlbGVtZW50IiwiYXBwZW5kQ2hpbGQiLCJkZWx0YSIsImZvckVhY2giLCJlIiwidXBkYXRlIiwiRGlzYyIsImNvb3JkcyIsInJhZGl1cyIsImN0eCIsIk1hdGgiLCJQSSIsIkciLCJwb3ciLCJQbGF5TW9kZSIsIlBMQVkiLCJrbVBlclB4IiwiZ2V0Rm9yY2UiLCJhIiwiYiIsImRpc3QiLCJhYnMiLCJDb25maWciLCJOdW1iZXIiLCJpc05hTiIsIm1hc3MiLCJnZXRGb3JjZVJhdGlvIiwiZGlyQSIsImRpckIiLCJjb29yZEEiLCJjb29yZEIiLCJ2ZWxvY2l0eSIsImFjYyIsImFjY2VsZXJhdGUiLCJpZCIsInBsYW5ldHMiLCJhcHBseSIsIlNjZW5lIiwiY2xlYXJSZWN0Iiwic3R5bGUiLCJiYWNrZ3JvdW5kQ29sb3IiLCJDYW1lcmEiLCJ6IiwidiIsImFjdGlvbkJ5S2V5Y29kZSIsIjgyIiwiOTAiLCI4OCIsIjM3IiwiMzgiLCIzOSIsIjQwIiwiZXZlbnQiLCJ1bmRlZmluZWQiLCJrZXlDb2RlIiwiVmVsb2NpdHkiLCJvYmoiLCJDb29yZGluYXRlcyIsIm1haW4iLCJ0MSIsImJvYXJkIiwid2luZG93IiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwib25yZWFkeXN0YXRlY2hhbmdlIiwicmVhZHlTdGF0ZSIsImJvZHkiLCJjbGllbnRXaWR0aCIsImNsaWVudEhlaWdodCIsImFwcGVuZFRvIiwic2NlbmUiLCJrZXlib2FyZENvbnRyb2xzIiwicGxhbmV0c0NvbmZpZyIsInN1biIsInJlbGF0aXZlWCIsInJlbGF0aXZlWSIsInF1ZXJ5U2VsZWN0b3IiLCJhZGRFdmVudExpc3RlbmVyIiwiaGFuZGxlS2V5Ym9hcmQiLCJwdXNoIl0sIm1hcHBpbmdzIjoiYUFDRSxJQUFJQSxFQUFtQixHQUd2QixTQUFTQyxFQUFvQkMsR0FHNUIsR0FBR0YsRUFBaUJFLEdBQ25CLE9BQU9GLEVBQWlCRSxHQUFVQyxRQUduQyxJQUFJQyxFQUFTSixFQUFpQkUsR0FBWSxDQUN6Q0csRUFBR0gsRUFDSEksR0FBRyxFQUNISCxRQUFTLElBVVYsT0FOQUksRUFBUUwsR0FBVU0sS0FBS0osRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0YsR0FHL0RHLEVBQU9FLEdBQUksRUFHSkYsRUFBT0QsUUFLZkYsRUFBb0JRLEVBQUlGLEVBR3hCTixFQUFvQlMsRUFBSVYsRUFHeEJDLEVBQW9CVSxFQUFJLFNBQVNSLEVBQVNTLEVBQU1DLEdBQzNDWixFQUFvQmEsRUFBRVgsRUFBU1MsSUFDbENHLE9BQU9DLGVBQWViLEVBQVNTLEVBQU0sQ0FBRUssWUFBWSxFQUFNQyxJQUFLTCxLQUtoRVosRUFBb0JrQixFQUFJLFNBQVNoQixHQUNYLG9CQUFYaUIsUUFBMEJBLE9BQU9DLGFBQzFDTixPQUFPQyxlQUFlYixFQUFTaUIsT0FBT0MsWUFBYSxDQUFFQyxNQUFPLFdBRTdEUCxPQUFPQyxlQUFlYixFQUFTLGFBQWMsQ0FBRW1CLE9BQU8sS0FRdkRyQixFQUFvQnNCLEVBQUksU0FBU0QsRUFBT0UsR0FFdkMsR0FEVSxFQUFQQSxJQUFVRixFQUFRckIsRUFBb0JxQixJQUMvQixFQUFQRSxFQUFVLE9BQU9GLEVBQ3BCLEdBQVcsRUFBUEUsR0FBOEIsaUJBQVZGLEdBQXNCQSxHQUFTQSxFQUFNRyxXQUFZLE9BQU9ILEVBQ2hGLElBQUlJLEVBQUtYLE9BQU9ZLE9BQU8sTUFHdkIsR0FGQTFCLEVBQW9Ca0IsRUFBRU8sR0FD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TUFBTyxDQUNDLE1BQVN5QyxFQUNULGNBVk0sQ0FDVnJHLEVBQUdxRyxFQUFJckcsRUFBSyxRQUFXbUQsRUFDdkJsRCxFQUFHb0csRUFBSXBHLEVBQ1BvQyxPQUFRLEdBQ1JpQixLQUFNLFFBQ05sQyxNQUFPLFVBQ1B3QyxTQUFVLENBQUVULEVBQW9CQSxFQUFpQixFQUFFLEVBQUlBLEVBQW9CQSxFQUFpQixFQUFFLElBSzFGLFdBQWMsQ0FDVm5ELEVBQUdxRyxFQUFJckcsRUFBSyxRQUFXbUQsRUFDdkJsRCxFQUFHb0csRUFBSXBHLEVBQUksR0FDWG9DLE9BQVEsR0FDUmlCLEtBQU0sUUFDTmxDLE1BQU8sTUFDUHdDLFNBQVUsQ0FBRVQsRUFBb0JBLEVBQWlCLEVBQUUsRUFBSUEsRUFBb0JBLEVBQWlCLEVBQUUsTURHcEYsQ0FBV3NDLEVBQU9oRyxHQUN4QyxJQUFJdUUsRUFBb0IsR0FFeEJ2QyxTQUFTK0UsY0FBYyxRQUFRQyxpQkFBaUIsVUFBV04sRUFBaUJPLGVBQWUzSCxLQUFLb0gsSUFFaEcsSUFBSyxJQUFJNUksS0FBSzZJLEVBQWUsQ0FDekIsTUFBTS9HLEVBQUkrRyxFQUFjN0ksR0FDeEJ5RyxFQUFRMkMsS0FBSyxJQUFJLEVBQU9wSixFQUNwQixJQUFJK0gsRUFBWWpHLEVBQUVXLEVBQUdYLEVBQUVZLEdBQ3ZCWixFQUFFZ0QsT0FDRmhELEVBQUVpRSxLQUNGakUsRUFBRStCLE1BQ0YsSUFBSWdFLEVBQVMvRixFQUFFdUUsU0FBUyxHQUFJdkUsRUFBRXVFLFNBQVMsSUFDdkNJLElBSVJrQyxFQUFNdEUsU0FBV29DLEVBQ2pCeUIsRUFBTTdELFNBQVMrRSxLQUFLVCxHQUVwQlgsRUFBSyxFQUFHLEVBQUdFIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsImltcG9ydCBNb2RlbCBmcm9tIFwiLi4vTW9kZWwvTW9kZWxcIlxuaW1wb3J0IENhbWVyYSBmcm9tIFwiLi4vQ2FtZXJhL0NhbWVyYVwiXG5pbXBvcnQgQ2FudmFzIGZyb20gXCIuL0NhbnZhc1wiXG5pbXBvcnQgVGV4dCBmcm9tIFwiLi4vVGV4dC9UZXh0XCJcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ29udGV4dCB7XG4gICAgY29uc3RydWN0b3IgKFxuICAgICAgICByZWFkb25seSBjb250ZXh0OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQsXG4gICAgICAgIHJlYWRvbmx5IGNhbWVyYTogQ2FtZXJhLFxuICAgICAgICByZWFkb25seSBjYW52YXM6IENhbnZhcyxcbiAgICAgICAgKSB7fVxuXG4gICAgZHJhdyhtb2RlbDogTW9kZWwpIHtcbiAgICAgICAgdGhpcy5jb250ZXh0LmJlZ2luUGF0aCgpXG4gICAgICAgIG1vZGVsLmRyYXcodGhpcylcbiAgICAgICAgdGhpcy5jb250ZXh0LnN0cm9rZSgpXG4gICAgfVxuXG4gICAgYXJjKHg6IG51bWJlciwgeTogbnVtYmVyLCByOiBudW1iZXIsIGFzOiBudW1iZXIsIGFlOiBudW1iZXIpOiBDb250ZXh0IHtcbiAgICAgICAgdGhpcy5jb250ZXh0LmFyYyh0aGlzLmNhbWVyYS5YKHgpLCB0aGlzLmNhbWVyYS5ZKHkpLCB0aGlzLmNhbWVyYS56VHJhbnNmb3JtKHIpLCBhcywgYWUpXG4gICAgICAgIHJldHVybiB0aGlzXG4gICAgfVxuXG4gICAgd3JpdGUodGV4dDogVGV4dCwgbGluZXM6IHN0cmluZ1tdKSB7XG4gICAgICAgIGNvbnN0IGZzID0gdGV4dC5nZXRGb250U2l6ZSgpXG4gICAgICAgIGNvbnN0IGZmID0gdGV4dC5nZXRGb250RmFtaWx5KClcbiAgICAgICAgY29uc3QgYyA9IHRleHQuZ2V0Q29vcmRpbmF0ZXMoKVxuXG4gICAgICAgIHRoaXMuY29udGV4dC5iZWdpblBhdGgoKVxuICAgICAgICB0aGlzLmNvbnRleHQuZm9udCA9IGAke2ZvbnRTaXplfXB4ICR7ZmZ9YFxuXG4gICAgICAgIGxpbmVzLm1hcCgobGluZSwgaSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5jb250ZXh0LmZpbGxUZXh0KGxpbmUsIGMueCwgYy55ICsgKGZzICogaSkpXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgZmlsbChjb2xvcjogc3RyaW5nKTogQ29udGV4dCB7XG4gICAgICAgIHRoaXMuY29udGV4dC5maWxsU3R5bGUgPSBjb2xvclxuICAgICAgICB0aGlzLmNvbnRleHQuZmlsbCgpXG4gICAgICAgIHJldHVybiB0aGlzXG4gICAgfVxufVxuXG50eXBlIERyYXdGdW5jdGlvbiA9IChjdHg6IENvbnRleHQpID0+IHZvaWRcblxuZXhwb3J0IHtcbiAgICBEcmF3RnVuY3Rpb25cbn0iLCJpbXBvcnQgRW50aXR5IGZyb20gXCIuLi9FbnRpdHkvRW50aXR5XCJcbmltcG9ydCBDb250ZXh0IGZyb20gXCIuL0NvbnRleHRcIlxuaW1wb3J0IENhbWVyYSBmcm9tIFwiLi4vQ2FtZXJhL0NhbWVyYVwiXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENhbnZhcyB7XG4gICAgcmVhZG9ubHkgY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudFxuICAgIHJlYWRvbmx5IGNvbnRleHQ6IENvbnRleHRcbiAgICBwdWJsaWMgZW50aXRpZXM6IEVudGl0eVtdXG5cbiAgICBjb25zdHJ1Y3Rvcih3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlciwgY2FtZXJhOiBDYW1lcmEpIHtcbiAgICAgICAgdGhpcy5jYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpXG4gICAgICAgIHRoaXMuY2FudmFzLndpZHRoID0gd2lkdGhcbiAgICAgICAgdGhpcy5jYW52YXMuaGVpZ2h0ID0gaGVpZ2h0XG4gICAgICAgIHRoaXMuY29udGV4dCA9IG5ldyBDb250ZXh0KHRoaXMuY2FudmFzLmdldENvbnRleHQoXCIyZFwiKSwgY2FtZXJhLCB0aGlzKVxuICAgICAgICB0aGlzLmVudGl0aWVzID0gW11cbiAgICB9XG5cbiAgICBhcHBlbmRUbyhlbGVtZW50OiBIVE1MRWxlbWVudCkge1xuICAgICAgICBlbGVtZW50LmFwcGVuZENoaWxkKHRoaXMuY2FudmFzKVxuICAgIH1cblxuICAgIHVwZGF0ZShkZWx0YTogbnVtYmVyKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZW50aXRpZXMuZm9yRWFjaChlID0+IHtcbiAgICAgICAgICAgIGUudXBkYXRlKGRlbHRhKVxuICAgICAgICAgICAgZS5kcmF3KGRlbHRhLCB0aGlzLmNvbnRleHQpXG4gICAgICAgIH0pXG4gICAgfVxufSIsImltcG9ydCBDb250ZXh0IGZyb20gXCIuLi9DYW52YXMvQ29udGV4dFwiXG5pbXBvcnQgQ29vcmRpbmF0ZXMgZnJvbSBcIi4uL1BoeXNpYy9Db29yZGluYXRlc1wiXG5pbXBvcnQgTW9kZWwgZnJvbSBcIi4vTW9kZWxcIlxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEaXNjIGltcGxlbWVudHMgTW9kZWwge1xuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyBjb29yZHM6IENvb3JkaW5hdGVzLCBwdWJsaWMgcmFkaXVzOiBudW1iZXIsIHB1YmxpYyBjb2xvcjogc3RyaW5nKSB7fVxuXG4gICAgZHJhdyhjdHg6IENvbnRleHQpIHtcbiAgICAgICAgY3R4LmFyYyh0aGlzLmNvb3Jkcy54LCB0aGlzLmNvb3Jkcy55LCB0aGlzLnJhZGl1cywgMCwgMiAqIE1hdGguUEkpXG4gICAgICAgIGN0eC5maWxsKHRoaXMuY29sb3IpXG4gICAgfVxuXG4gICAgZ2V0Q29vcmRpbmF0ZXMoKTogQ29vcmRpbmF0ZXMge1xuICAgICAgICByZXR1cm4gdGhpcy5jb29yZHNcbiAgICB9XG5cbiAgICBzZXRDb29yZGluYXRlcyhjb29yZHM6IENvb3JkaW5hdGVzKTogdm9pZCB7XG4gICAgICAgIHRoaXMuY29vcmRzID0gY29vcmRzXG4gICAgfVxufSIsImNvbnN0IGNEdXJhdGlvbiA9IDBcbmNvbnN0IGZwcyA9IDIwXG5jb25zdCBkcGYgPSAxIC8gZnBzICogMTAwMFxubGV0IHpvb21MZXZlbCA9IDIuNVxubGV0IHpvb21NaW4gPSAwLjFcbmNvbnN0IHpvb21BY3Rpb25Qb3cgPSAwLjEwXG5jb25zdCBkZWNhbEJ5TW92ZSA9IDI1XG5cbmxldCBtYXhQbGFuZXRzID0gNFxubGV0IHBsYW5ldHNSYWRpdXNEZWYgPSB7bWluOiAzLCBtYXg6IDcwfVxuY29uc3QgcGxhbmV0c01pbkRpc3QgPSAxMFxuY29uc3QgcGxhbmV0QmFzZVNwZWVkID0gNDBcblxuY29uc3Qgc3BhY2VXID0gMTAwMDBcbmNvbnN0IHNwYWNlSCA9IDEwMDAwXG5jb25zdCBkZWNhbFggPSBzcGFjZVcgLyAyXG5jb25zdCBkZWNhbFkgPSBzcGFjZUggLyAyXG5cbmNvbnN0IGdyYXZpdHlQdWxsQnlEZWx0YSA9IDFcbmNvbnN0IGRpc3RQb3cgPSA1XG5cbmNvbnN0IGZvbnRTaXplID0gMTRcbmxldCBkZWJ1ZyA9IG51bGxcbmNvbnN0IGVhcnRoU3BlZWQgPSAyOS43OCAqIDEwMDBcbmNvbnN0IEcgPSBNYXRoLnBvdygxMCwgLTExKSAqIDYuNjc0XG5cbmVudW0gUGxheU1vZGUge1xuICAgIFBMQVksXG4gICAgUEFVU0Vcbn1cblxuY29uc3QgbW9kZSA9IFBsYXlNb2RlLlBMQVlcbi8vIGNvbnN0IGttUGVyUHggPSAxLjNlNVxuY29uc3Qga21QZXJQeCA9IDEuOGU1XG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgICBnYW1lU3BlZWQ6IDM2NSAqIDI0ICogNjAgKiAxNSxcbiAgICAvLyBnYW1lU3BlZWQ6IDEwMCxcbiAgICBrbVBlclB4LFxuICAgIG1QZXJQeDoga21QZXJQeCAqIDEwMDAsXG4gICAga2dQZXJQeERlbnNpdHk6IDEyMDAsXG4gICAgRyxcbiAgICBncmF2aXR5UHVsbEJ5RGVsdGEsXG4gICAgY0R1cmF0aW9uLFxuICAgIGZwcyxcbiAgICBkcGYsXG4gICAgem9vbUxldmVsLFxuICAgIHpvb21BY3Rpb25Qb3csXG4gICAgZGVjYWxCeU1vdmUsXG4gICAgbWF4UGxhbmV0cyxcbiAgICBwbGFuZXRzUmFkaXVzRGVmLFxuICAgIHBsYW5ldHNNaW5EaXN0LFxuICAgIHBsYW5ldEJhc2VTcGVlZCxcbiAgICBzcGFjZVcsXG4gICAgc3BhY2VILFxuICAgIGRlY2FsWCxcbiAgICBkZWNhbFksXG4gICAgZGlzdFBvdyxcbiAgICBmb250U2l6ZSxcbiAgICBkZWJ1ZyxcbiAgICBQbGF5TW9kZSxcbiAgICBtb2RlLFxuICAgIHpvb21NaW4sXG4gICAgZWFydGhTcGVlZFxufSIsImltcG9ydCBDb29yZGluYXRlcyBmcm9tIFwiLi9Db29yZGluYXRlc1wiXG5pbXBvcnQgQ29uZmlnIGZyb20gXCIuLi9Db25maWdcIlxuXG5jb25zdCBnZXREaXN0YW5jZUJldHdlZW5PYmplY3RzID0gKGE6IENvb3JkaW5hdGVzLCBiOiBDb29yZGluYXRlcyk6IG51bWJlciA9PiB7XG4gICAgcmV0dXJuIChNYXRoLmFicyhiLnggLSBhLngpICsgTWF0aC5hYnMoYi55IC0gYS55KSkgKiBDb25maWcubVBlclB4XG59XG5cbmV4cG9ydCB7XG4gICAgZ2V0RGlzdGFuY2VCZXR3ZWVuT2JqZWN0c1xufSIsImltcG9ydCBWZWxvY2l0eSBmcm9tIFwiLi9WZWxvY2l0eVwiO1xuaW1wb3J0IFBsYW5ldCBmcm9tIFwiLi4vUGxhbmV0XCJcbmltcG9ydCBDb29yZGluYXRlcyBmcm9tIFwiLi9Db29yZGluYXRlc1wiXG5pbXBvcnQgKiBhcyBHZW9tZXRyeSBmcm9tIFwiLi9HZW9tZXRyeVwiXG5pbXBvcnQgQ29uZmlnIGZyb20gXCIuLi9Db25maWdcIlxuXG5jb25zdCBnZXRGb3JjZSA9IChhOiBQbGFuZXQsIGI6IFBsYW5ldCk6IG51bWJlciA9PiB7XG4gICAgY29uc3QgZGlzdCA9IEdlb21ldHJ5LmdldERpc3RhbmNlQmV0d2Vlbk9iamVjdHMoYS5jb29yZHMsIGIuY29vcmRzKVxuICAgIGlmIChkaXN0ID09IDAgfHwgTnVtYmVyLmlzTmFOKGRpc3QpKSB7XG4gICAgICAgIHJldHVybiBcbiAgICB9XG4gICAgY29uc3QgRiA9IENvbmZpZy5HICogKChhLm1hc3MqYi5tYXNzKS8oZGlzdCpkaXN0KSlcblxuICAgIHJldHVybiBGICogQ29uZmlnLmdyYXZpdHlQdWxsQnlEZWx0YVxufVxuXG5jb25zdCBnZXRGb3JjZVJhdGlvID0gKGRpckE6IG51bWJlciwgZGlyQjogbnVtYmVyLCBjb29yZEE6IENvb3JkaW5hdGVzLCBjb29yZEI6IENvb3JkaW5hdGVzKTogbnVtYmVyID0+IHtcbiAgICByZXR1cm4gLShkaXJBIC0gZGlyQikgLyAoTWF0aC5hYnMoY29vcmRBLnggLSBjb29yZEIueCkgKyBNYXRoLmFicyhjb29yZEEueSAtIGNvb3JkQi55KSlcbn1cblxuZXhwb3J0IGRlZmF1bHQgKHZlbG9jaXR5OiBWZWxvY2l0eSwgYTogUGxhbmV0LCBiOiBQbGFuZXQsIGRlbHRhOiBudW1iZXIpID0+IHtcbiAgICBjb25zdCBhY2MgPSAoZ2V0Rm9yY2UoYSwgYikgLyBhLm1hc3MpIC8gQ29uZmlnLm1QZXJQeFxuICAgIHZlbG9jaXR5LmFjY2VsZXJhdGUoXG4gICAgICAgIGFjYyAqIGdldEZvcmNlUmF0aW8oYS5jb29yZHMueCwgYi5jb29yZHMueCwgYS5jb29yZHMsIGIuY29vcmRzKSxcbiAgICAgICAgYWNjICogZ2V0Rm9yY2VSYXRpbyhhLmNvb3Jkcy55LCBiLmNvb3Jkcy55LCBhLmNvb3JkcywgYi5jb29yZHMpLFxuICAgICAgICBkZWx0YVxuICAgIClcbn0iLCJpbXBvcnQgRW50aXR5IGZyb20gXCIuL0VudGl0eS9FbnRpdHlcIlxuaW1wb3J0IENvb3JkaW5hdGVzIGZyb20gXCIuL1BoeXNpYy9Db29yZGluYXRlc1wiXG5pbXBvcnQgQ29udGV4dCBmcm9tIFwiLi9DYW52YXMvQ29udGV4dFwiXG5pbXBvcnQgRGlzYyBmcm9tIFwiLi9Nb2RlbC9EaXNjXCJcbmltcG9ydCBWZWxvY2l0eSBmcm9tIFwiLi9QaHlzaWMvVmVsb2NpdHlcIlxuaW1wb3J0IGFwcGx5R3Jhdml0eSBmcm9tIFwiLi9QaHlzaWMvR3Jhdml0eVwiXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBsYW5ldCBpbXBsZW1lbnRzIEVudGl0eSB7XG4gICAgcHVibGljIGVudGl0aWVzOiBFbnRpdHlbXSA9IFtdXG4gICAgcHVibGljIG1vZGVsOiBEaXNjXG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHVibGljIGlkOiBzdHJpbmcsXG4gICAgICAgIHB1YmxpYyBjb29yZHM6IENvb3JkaW5hdGVzLFxuICAgICAgICByZWFkb25seSByYWRpdXM6IG51bWJlcixcbiAgICAgICAgcmVhZG9ubHkgbWFzczogbnVtYmVyLFxuICAgICAgICByZWFkb25seSBjb2xvcjogc3RyaW5nLFxuICAgICAgICBwdWJsaWMgdmVsb2NpdHk6IFZlbG9jaXR5LFxuICAgICAgICByZWFkb25seSBwbGFuZXRzOiBQbGFuZXRbXVxuICAgICAgICApIHtcbiAgICAgICAgICAgIHRoaXMubW9kZWwgPSBuZXcgRGlzYyh0aGlzLmNvb3JkcywgdGhpcy5yYWRpdXMsIHRoaXMuY29sb3IpXG4gICAgICAgIH1cblxuICAgIGdldEVudGl0aWVzKCk6IEVudGl0eVtdIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZW50aXRpZXNcbiAgICB9XG5cbiAgICB1cGRhdGUoZGVsdGE6IG51bWJlcik6IHZvaWQge1xuICAgICAgICBmb3IgKGxldCBpIGluIHRoaXMucGxhbmV0cykge1xuICAgICAgICAgICAgY29uc3QgcCA9IHRoaXMucGxhbmV0c1tpXVxuXG4gICAgICAgICAgICBpZiAocC5pZCA9PSB0aGlzLmlkKSB7XG4gICAgICAgICAgICAgICAgY29udGludWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFwcGx5R3Jhdml0eSh0aGlzLnZlbG9jaXR5LCB0aGlzLCBwLCBkZWx0YSlcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnZlbG9jaXR5LmFwcGx5KHRoaXMuY29vcmRzLCBkZWx0YSlcbiAgICAgICAgdGhpcy5lbnRpdGllcy5mb3JFYWNoKGUgPT4gZS51cGRhdGUoZGVsdGEpKVxuICAgIH1cblxuICAgIGRyYXcoZGVsdGE6IG51bWJlciwgY29udGV4dDogQ29udGV4dCk6IHZvaWQge1xuICAgICAgICBjb250ZXh0LmRyYXcodGhpcy5tb2RlbClcbiAgICB9XG5cbiAgICBnZXRDb29yZGluYXRlcygpOiBDb29yZGluYXRlcyB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvb3Jkc1xuICAgIH1cblxuICAgIHNldENvb3JkaW5hdGVzKGNvb3JkczogQ29vcmRpbmF0ZXMpOiB2b2lkIHtcbiAgICAgICAgLy8gY29uc29sZS5sb2coY29vcmRzKVxuICAgICAgICB0aGlzLmNvb3JkcyA9IGNvb3Jkc1xuICAgICAgICAvLyB0aGlzLm1vZGVsLnNldENvb3JkaW5hdGVzKHRoaXMuY29vcmRzKVxuICAgIH1cbn0iLCJpbXBvcnQgRW50aXR5IGZyb20gXCIuLi9FbnRpdHkvRW50aXR5XCJcbmltcG9ydCBDb250ZXh0IGZyb20gXCIuLi9DYW52YXMvQ29udGV4dFwiXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNjZW5lIGltcGxlbWVudHMgRW50aXR5IHtcbiAgICBwdWJsaWMgZW50aXRpZXM6IEVudGl0eVtdID0gW11cblxuICAgIHVwZGF0ZShkZWx0YTogbnVtYmVyKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZW50aXRpZXMuZm9yRWFjaChlID0+IGUudXBkYXRlKGRlbHRhKSlcbiAgICB9XG5cbiAgICBkcmF3KGRlbHRhOiBudW1iZXIsIGNvbnRleHQ6IENvbnRleHQpOiB2b2lkIHtcbiAgICAgICAgY29udGV4dC5jb250ZXh0LmNsZWFyUmVjdCgwLCAwLCBjb250ZXh0LmNhbnZhcy5jYW52YXMud2lkdGgsIGNvbnRleHQuY2FudmFzLmNhbnZhcy5oZWlnaHQpO1xuICAgICAgICBjb250ZXh0LmNhbnZhcy5jYW52YXMuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCIjMDAwMDAwXCJcbiAgICAgICAgdGhpcy5lbnRpdGllcy5mb3JFYWNoKGUgPT4gZS5kcmF3KGRlbHRhLCBjb250ZXh0KSlcbiAgICAgICAgY29udGV4dC5jb250ZXh0LnN0cm9rZSgpOyAgICBcbiAgICB9XG5cbiAgICBnZXRFbnRpdGllcygpOiBFbnRpdHlbXSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVudGl0aWVzXG4gICAgfVxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhbWVyYSB7XG4gICAgcHVibGljIHg6IG51bWJlciA9IDBcbiAgICBwdWJsaWMgeTogbnVtYmVyID0gMFxuICAgIHB1YmxpYyB6OiBudW1iZXIgPSAxXG5cbiAgICBjb25zdHJ1Y3Rvcih4OiBudW1iZXIsIHk6IG51bWJlciwgejogbnVtYmVyKSB7XG4gICAgICAgIHRoaXMueCA9IHhcbiAgICAgICAgdGhpcy55ID0geVxuICAgICAgICB0aGlzLnogPSB6XG4gICAgfVxuXG4gICAgWCh4OiBudW1iZXIpOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gdGhpcy56VHJhbnNmb3JtKHggLSB0aGlzLngpXG4gICAgfVxuXG4gICAgWSh5OiBudW1iZXIpOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gdGhpcy56VHJhbnNmb3JtKHkgLSB0aGlzLnkpXG4gICAgfVxuXG4gICAgelRyYW5zZm9ybSh2OiBudW1iZXIpOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gdiAqICgxIC8gdGhpcy56KVxuICAgIH1cblxuICAgIHJlbGF0aXZlWCh4OiBudW1iZXIpOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gdGhpcy54ICsgeFxuICAgIH1cblxuICAgIHJlbGF0aXZlWSh5OiBudW1iZXIpOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gdGhpcy55ICsgeVxuICAgIH1cbn0iLCJpbXBvcnQgQ2FtZXJhIGZyb20gXCIuLi9DYW1lcmEvQ2FtZXJhXCJcbmltcG9ydCBDb25maWcgZnJvbSBcIi4uL0NvbmZpZ1wiXG5pbXBvcnQgQ2FudmFzIGZyb20gXCIuLi9DYW52YXMvQ2FudmFzXCJcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgS2V5Ym9hcmQge1xuICAgIHB1YmxpYyBhY3Rpb25CeUtleWNvZGU6IHtba2V5OiBudW1iZXJdOiBGdW5jdGlvbn1cblxuICAgIGNvbnN0cnVjdG9yKHJlYWRvbmx5IGNhbWVyYTogQ2FtZXJhLCByZWFkb25seSBjYW52YXM6IENhbnZhcykge1xuICAgICAgICB0aGlzLmFjdGlvbkJ5S2V5Y29kZSA9IHtcbiAgICAgICAgICAgIC8vIDY4OiAoKSA9PiB7ZGVidWcuVG9nZ2xlKCk7fSxcbiAgICAgICAgICAgIC8vIDgzOiAoKSA9PiB7bW9kZSA9IG1vZGUgPT0gUEFVU0UgPyBQTEFZIDogUEFVU0U7fSxcbiAgICAgICAgICAgIDgyOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5jYW1lcmEueCA9IDBcbiAgICAgICAgICAgICAgICB0aGlzLmNhbWVyYS55ID0gMFxuICAgICAgICAgICAgICAgIHRoaXMuY2FtZXJhLnogPSAxXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgOTA6ICgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jYW1lcmEueiA8PSBDb25maWcuem9vbU1pbikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5jYW1lcmEueiAtPSBDb25maWcuem9vbUFjdGlvblBvd1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIDg4OiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5jYW1lcmEueiArPSBDb25maWcuem9vbUFjdGlvblBvd1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIDM3OiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY2FtZXJhLnggLSBDb25maWcuZGVjYWxCeU1vdmUgPD0gMCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuY2FtZXJhLnggLT0gQ29uZmlnLmRlY2FsQnlNb3ZlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgMzg6ICgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jYW1lcmEueSAtIENvbmZpZy5kZWNhbEJ5TW92ZSA8PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5jYW1lcmEueSAtPSBDb25maWcuZGVjYWxCeU1vdmVcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAzOTogKCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNhbWVyYS54ID49IENvbmZpZy5zcGFjZVcpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmNhbWVyYS54ICs9IENvbmZpZy5kZWNhbEJ5TW92ZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIDQwOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY2FtZXJhLnkgPj0gQ29uZmlnLnNwYWNlSCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuY2FtZXJhLnkgKz0gQ29uZmlnLmRlY2FsQnlNb3ZlXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBoYW5kbGVLZXlib2FyZChldmVudDogS2V5Ym9hcmRFdmVudCkge1xuICAgICAgICBpZiAodGhpcy5hY3Rpb25CeUtleWNvZGUgPT0gdW5kZWZpbmVkIHx8IFxuICAgICAgICAgICAgIXRoaXMuYWN0aW9uQnlLZXljb2RlW2V2ZW50LmtleUNvZGVdKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5hY3Rpb25CeUtleWNvZGVbZXZlbnQua2V5Q29kZV0oKTtcbiAgICB9XG59IiwiaW1wb3J0IENvb3JkaW5hdGVzIGZyb20gXCIuL0Nvb3JkaW5hdGVzXCJcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVmVsb2NpdHkge1xuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyB4OiBudW1iZXIsIHB1YmxpYyB5OiBudW1iZXIpIHt9XG5cbiAgICBhY2NlbGVyYXRlKHg6IG51bWJlciwgeTogbnVtYmVyLCBkZWx0YTogbnVtYmVyKSB7XG4gICAgICAgIHRoaXMueCArPSB4ICogZGVsdGFcbiAgICAgICAgdGhpcy55ICs9IHkgKiBkZWx0YVxuICAgIH1cblxuICAgIGFwcGx5KG9iajogQ29vcmRpbmF0ZXMsIGRlbHRhOiBudW1iZXIpIHtcbiAgICAgICAgb2JqLnggKz0gdGhpcy54ICogZGVsdGFcbiAgICAgICAgb2JqLnkgKz0gdGhpcy55ICogZGVsdGFcbiAgICB9XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ29vcmRpbmF0ZXMge1xuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyB4OiBudW1iZXIsIHB1YmxpYyB5OiBudW1iZXIpIHt9XG5cbiAgICBzZXRDb29yZGluYXRlcyh4OiBudW1iZXIsIHk6IG51bWJlcik6IHZvaWQge1xuICAgICAgICB0aGlzLnggPSB4XG4gICAgICAgIHRoaXMueSA9IHlcbiAgICB9XG59IiwiaW1wb3J0IENhbnZhcyBmcm9tIFwiLi9zcmMvQ2FudmFzL0NhbnZhc1wiXG5pbXBvcnQgUGxhbmV0IGZyb20gXCIuL3NyYy9QbGFuZXRcIlxuaW1wb3J0IFNjZW5lIGZyb20gXCIuL3NyYy9TY2VuZS9pbmRleFwiXG5pbXBvcnQgQ2FtZXJhIGZyb20gXCIuL3NyYy9DYW1lcmEvQ2FtZXJhXCJcbmltcG9ydCBLZXlib2FyZCBmcm9tIFwiLi9zcmMvQ29udHJvbHMvS2V5Ym9hcmRcIlxuaW1wb3J0IENvbmZpZyBmcm9tIFwiLi9zcmMvQ29uZmlnXCJcbmltcG9ydCBWZWxvY2l0eSBmcm9tIFwiLi9zcmMvUGh5c2ljL1ZlbG9jaXR5XCJcbmltcG9ydCBDb29yZGluYXRlcyBmcm9tIFwiLi9zcmMvUGh5c2ljL0Nvb3JkaW5hdGVzXCJcblxuaW1wb3J0IGdldFBsYW5ldHMgZnJvbSBcIi4vcGxhbmV0c1wiXG5cbmxldCBjVGltZSA9IDBcblxuY29uc3QgbWFpbiA9ICh0MTogbnVtYmVyLCBkZWx0YTogbnVtYmVyLCBib2FyZDogQ2FudmFzKSA9PiB7XG4gICAgLy8gY1RpbWUgKz0gZGVsdGFcbiAgICAvLyBpZiAoY1RpbWUgPiBDb25maWcuZHBmKSB7XG4gICAgYm9hcmQudXBkYXRlKChkZWx0YSAvIDEwMDApICogQ29uZmlnLmdhbWVTcGVlZClcbiAgICAvLyBjVGltZSAtPSBDb25maWcuZHBmXG4gICAgLy8gfVxuXG4gICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSh0ID0+IG1haW4odCwgdCAtIHQxLCBib2FyZCkpXG59XG5cbmRvY3VtZW50Lm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSAhPSBcImNvbXBsZXRlXCIpIHtcbiAgICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGNvbnN0IGNhbWVyYSA9IG5ldyBDYW1lcmEoQ29uZmlnLnNwYWNlVyAvIDIsIENvbmZpZy5zcGFjZUggLyAyLCBDb25maWcuem9vbUxldmVsKVxuICAgIGNvbnN0IGJvYXJkID0gbmV3IENhbnZhcyhkb2N1bWVudC5ib2R5LmNsaWVudFdpZHRoLCBkb2N1bWVudC5ib2R5LmNsaWVudEhlaWdodCwgY2FtZXJhKVxuICAgIGJvYXJkLmFwcGVuZFRvKGRvY3VtZW50LmJvZHkpXG4gICAgXG4gICAgY29uc3Qgc2NlbmUgPSBuZXcgU2NlbmUoKVxuICAgIGNvbnN0IGtleWJvYXJkQ29udHJvbHMgPSBuZXcgS2V5Ym9hcmQoY2FtZXJhLCBib2FyZClcbiAgICBjb25zdCBwbGFuZXRzQ29uZmlnID0gZ2V0UGxhbmV0cyhib2FyZCwgY2FtZXJhKVxuICAgIGxldCBwbGFuZXRzOiBQbGFuZXRbXSA9IFtdXG5cbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiYm9keVwiKS5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBrZXlib2FyZENvbnRyb2xzLmhhbmRsZUtleWJvYXJkLmJpbmQoa2V5Ym9hcmRDb250cm9scykpO1xuICAgIFxuICAgIGZvciAobGV0IGkgaW4gcGxhbmV0c0NvbmZpZykge1xuICAgICAgICBjb25zdCBwID0gcGxhbmV0c0NvbmZpZ1tpXVxuICAgICAgICBwbGFuZXRzLnB1c2gobmV3IFBsYW5ldChpLFxuICAgICAgICAgICAgbmV3IENvb3JkaW5hdGVzKHAueCwgcC55KSxcbiAgICAgICAgICAgIHAucmFkaXVzLFxuICAgICAgICAgICAgcC5tYXNzLFxuICAgICAgICAgICAgcC5jb2xvcixcbiAgICAgICAgICAgIG5ldyBWZWxvY2l0eShwLnZlbG9jaXR5WzBdLCBwLnZlbG9jaXR5WzFdKSxcbiAgICAgICAgICAgIHBsYW5ldHNcbiAgICAgICAgICAgICkpXG4gICAgfVxuXG4gICAgc2NlbmUuZW50aXRpZXMgPSBwbGFuZXRzXG4gICAgYm9hcmQuZW50aXRpZXMucHVzaChzY2VuZSlcbiAgICBcbiAgICBtYWluKDAsIDAsIGJvYXJkKVxuIH0iLCJpbXBvcnQgQ2FudmFzIGZyb20gXCIuL3NyYy9DYW52YXMvQ2FudmFzXCJcbmltcG9ydCBDYW1lcmEgZnJvbSBcIi4vc3JjL0NhbWVyYS9DYW1lcmFcIlxuaW1wb3J0IENvbmZpZyBmcm9tIFwiLi9zcmMvQ29uZmlnXCJcblxuZXhwb3J0IGRlZmF1bHQgKGNhbnZhczogQ2FudmFzLCBjYW1lcmE6IENhbWVyYSk6IHtba2V5OiBzdHJpbmddOiBhbnl9ID0+IHtcbiAgICBjb25zdCBzdW4gPSB7XG4gICAgICAgIHg6IGNhbWVyYS5yZWxhdGl2ZVgoY2FtZXJhLnogKiAoY2FudmFzLmNhbnZhcy53aWR0aCAvIDIpKSxcbiAgICAgICAgeTogY2FtZXJhLnJlbGF0aXZlWShjYW1lcmEueiAqIChjYW52YXMuY2FudmFzLmhlaWdodCAvIDIpKSxcbiAgICAgICAgcmFkaXVzOiAxMjAsXG4gICAgICAgIG1hc3M6IDEuOTg5MWUzMCxcbiAgICAgICAgY29sb3I6IFwib3JhbmdlXCIsXG4gICAgICAgIHZlbG9jaXR5OiBbMCwgMF1cbiAgICB9XG4gICAgY29uc3QgZWFydGggPSB7XG4gICAgICAgIHg6IHN1bi54IC0gKDE0OS45NmU5IC8gQ29uZmlnLm1QZXJQeCksXG4gICAgICAgIHk6IHN1bi55LFxuICAgICAgICByYWRpdXM6IDMwLFxuICAgICAgICBtYXNzOiA1Ljk3MmUyNCxcbiAgICAgICAgY29sb3I6IFwic2t5Ymx1ZVwiLFxuICAgICAgICB2ZWxvY2l0eTogWyhDb25maWcuZWFydGhTcGVlZCAvIENvbmZpZy5tUGVyUHgpICogMS8zLCAoQ29uZmlnLmVhcnRoU3BlZWQgLyBDb25maWcubVBlclB4KSAqIDIvM11cbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgICAgIFwic3VuNDFcIjogc3VuLFxuICAgICAgICAgICAgXCJlYXJ0aCBhbG9yc1wiOiBlYXJ0aCxcbiAgICAgICAgICAgIFwiaW50ZXJsb3BlclwiOiB7XG4gICAgICAgICAgICAgICAgeDogc3VuLnggKyAoMTAwLjk2ZTkgLyBDb25maWcubVBlclB4KSxcbiAgICAgICAgICAgICAgICB5OiBzdW4ueSArIDIwLFxuICAgICAgICAgICAgICAgIHJhZGl1czogMjQsXG4gICAgICAgICAgICAgICAgbWFzczogMy45NzJlMjQsXG4gICAgICAgICAgICAgICAgY29sb3I6IFwicmVkXCIsXG4gICAgICAgICAgICAgICAgdmVsb2NpdHk6IFsoQ29uZmlnLmVhcnRoU3BlZWQgLyBDb25maWcubVBlclB4KSAqIDEvMywgKENvbmZpZy5lYXJ0aFNwZWVkIC8gQ29uZmlnLm1QZXJQeCkgKiAyLzNdXG4gICAgICAgICAgICB9XG4gICAgfVxufSJdLCJzb3VyY2VSb290IjoiIn0=